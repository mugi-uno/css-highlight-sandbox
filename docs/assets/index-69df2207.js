(function(){const Ue=document.createElement("link").relList;if(Ue&&Ue.supports&&Ue.supports("modulepreload"))return;for(const fe of document.querySelectorAll('link[rel="modulepreload"]'))ue(fe);new MutationObserver(fe=>{for(const Oe of fe)if(Oe.type==="childList")for(const He of Oe.addedNodes)He.tagName==="LINK"&&He.rel==="modulepreload"&&ue(He)}).observe(document,{childList:!0,subtree:!0});function xe(fe){const Oe={};return fe.integrity&&(Oe.integrity=fe.integrity),fe.referrerPolicy&&(Oe.referrerPolicy=fe.referrerPolicy),fe.crossOrigin==="use-credentials"?Oe.credentials="include":fe.crossOrigin==="anonymous"?Oe.credentials="omit":Oe.credentials="same-origin",Oe}function ue(fe){if(fe.ep)return;fe.ep=!0;const Oe=xe(fe);fetch(fe.href,Oe)}})();function Dt(Pe){return Pe&&Pe.__esModule&&Object.prototype.hasOwnProperty.call(Pe,"default")?Pe.default:Pe}var At={exports:{}},yt={exports:{}},xt;function Pt(){return xt||(xt=1,function(Pe,Ue){(function(xe,ue){Pe.exports=xe()})(function(){var xe="object",ue="function",fe="undefined",Oe=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],He=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],at=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],Ee=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function Ie(c,C){var v=typeof c[C];return v==ue||!!(v==xe&&c[C])||v=="unknown"}function ke(c,C){return!!(typeof c[C]==xe&&c[C])}function Ge(c,C){return typeof c[C]!=fe}function Qe(c){return function(C,v){for(var w=v.length;w--;)if(!c(C,v[w]))return!1;return!0}}var ot=Qe(Ie),Rt=Qe(ke),et=Qe(Ge);function dt(c){return c&&ot(c,Ee)&&et(c,at)}function tt(c){return ke(c,"body")?c.body:c.getElementsByTagName("body")[0]}var st=[].forEach?function(c,C){c.forEach(C)}:function(c,C){for(var v=0,w=c.length;v<w;++v)C(c[v],v)},$e={},We=typeof window!=fe&&typeof document!=fe,Fe={isHostMethod:Ie,isHostObject:ke,isHostProperty:Ge,areHostMethods:ot,areHostObjects:Rt,areHostProperties:et,isTextRange:dt,getBody:tt,forEach:st},V={version:"1.3.1",initialized:!1,isBrowser:We,supported:!0,util:Fe,features:{},modules:$e,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==fe?!0:rangyAutoInitialize}};function nt(c){typeof console!=fe&&Ie(console,"log")&&console.log(c)}function rt(c,C){We&&C?alert(c):nt(c)}function Ve(c){V.initialized=!0,V.supported=!1,rt("Rangy is not supported in this environment. Reason: "+c,V.config.alertOnFail)}V.fail=Ve;function Ct(c){rt("Rangy warning: "+c,V.config.alertOnWarn)}V.warn=Ct;var it;({}).hasOwnProperty?(Fe.extend=it=function(c,C,v){var w,x;for(var M in C)C.hasOwnProperty(M)&&(w=c[M],x=C[M],v&&w!==null&&typeof w=="object"&&x!==null&&typeof x=="object"&&it(w,x,!0),c[M]=x);return C.hasOwnProperty("toString")&&(c.toString=C.toString),c},Fe.createOptions=function(c,C){var v={};return it(v,C),c&&it(v,c),v}):Ve("hasOwnProperty not supported"),We||Ve("Rangy can only run in a browser"),function(){var c;if(We){var C=document.createElement("div");C.appendChild(document.createElement("span"));var v=[].slice;try{v.call(C.childNodes,0)[0].nodeType==1&&(c=function(w){return v.call(w,0)})}catch{}}c||(c=function(w){for(var x=[],M=0,L=w.length;M<L;++M)x[M]=w[M];return x}),Fe.toArray=c}();var Ke;We&&(Ie(document,"addEventListener")?Ke=function(c,C,v){c.addEventListener(C,v,!1)}:Ie(document,"attachEvent")?Ke=function(c,C,v){c.attachEvent("on"+C,v)}:Ve("Document does not have required addEventListener or attachEvent method"),Fe.addListener=Ke);var ct=[];function ht(c){return c.message||c.description||String(c)}function lt(){if(!(!We||V.initialized)){var c,C=!1,v=!1;Ie(document,"createRange")&&(c=document.createRange(),ot(c,He)&&et(c,Oe)&&(C=!0));var w=tt(document);if(!w||w.nodeName.toLowerCase()!="body"){Ve("No body element found");return}if(w&&Ie(w,"createTextRange")&&(c=w.createTextRange(),dt(c)&&(v=!0)),!C&&!v){Ve("Neither Range nor TextRange are available");return}V.initialized=!0,V.features={implementsDomRange:C,implementsTextRange:v};var x,M;for(var L in $e)(x=$e[L])instanceof Ze&&x.init(x,V);for(var re=0,ce=ct.length;re<ce;++re)try{ct[re](V)}catch(de){M="Rangy init listener threw an exception. Continuing. Detail: "+ht(de),nt(M)}}}function gt(c,C,v){v&&(c+=" in module "+v.name),V.warn("DEPRECATED: "+c+" is deprecated. Please use "+C+" instead.")}function pt(c,C,v,w){c[C]=function(){return gt(C,v,w),c[v].apply(c,Fe.toArray(arguments))}}Fe.deprecationNotice=gt,Fe.createAliasForDeprecatedMethod=pt,V.init=lt,V.addInitListener=function(c){V.initialized?c(V):ct.push(c)};var Ye=[];V.addShimListener=function(c){Ye.push(c)};function Xe(c){c=c||window,lt();for(var C=0,v=Ye.length;C<v;++C)Ye[C](c)}We&&(V.shim=V.createMissingNativeApi=Xe,pt(V,"createMissingNativeApi","shim"));function Ze(c,C,v){this.name=c,this.dependencies=C,this.initialized=!1,this.supported=!1,this.initializer=v}Ze.prototype={init:function(){for(var c=this.dependencies||[],C=0,v=c.length,w,x;C<v;++C){if(x=c[C],w=$e[x],!w||!(w instanceof Ze))throw new Error("required module '"+x+"' not found");if(w.init(),!w.supported)throw new Error("required module '"+x+"' not supported")}this.initializer(this)},fail:function(c){throw this.initialized=!0,this.supported=!1,new Error(c)},warn:function(c){V.warn("Module "+this.name+": "+c)},deprecationNotice:function(c,C){V.warn("DEPRECATED: "+c+" in module "+this.name+" is deprecated. Please use "+C+" instead")},createError:function(c){return new Error("Error in Rangy "+this.name+" module: "+c)}};function ut(c,C,v){var w=new Ze(c,C,function(x){if(!x.initialized){x.initialized=!0;try{v(V,x),x.supported=!0}catch(L){var M="Module '"+c+"' failed to load: "+ht(L);nt(M),L.stack&&nt(L.stack)}}});return $e[c]=w,w}V.createModule=function(c){var C,v;arguments.length==2?(C=arguments[1],v=[]):(C=arguments[2],v=arguments[1]);var w=ut(c,v,C);V.initialized&&V.supported&&w.init()},V.createCoreModule=function(c,C,v){ut(c,C,v)};function Je(){}V.RangePrototype=Je,V.rangePrototype=new Je;function vt(){}V.selectionPrototype=new vt,V.createCoreModule("DomUtil",[],function(c,C){var v="undefined",w=c.util,x=w.getBody;w.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||C.fail("document missing a Node creation method"),w.isHostMethod(document,"getElementsByTagName")||C.fail("document missing getElementsByTagName method");var M=document.createElement("div");w.areHostMethods(M,["insertBefore","appendChild","cloneNode"])||C.fail("Incomplete Element implementation"),w.isHostProperty(M,"innerHTML")||C.fail("Element is missing innerHTML property");var L=document.createTextNode("test");w.areHostMethods(L,["splitText","deleteData","insertData","appendData","cloneNode"])||C.fail("Incomplete Text Node implementation");var re=function(l,p){for(var k=l.length;k--;)if(l[k]===p)return!0;return!1};function ce(l){var p;return typeof l.namespaceURI==v||(p=l.namespaceURI)===null||p=="http://www.w3.org/1999/xhtml"}function de(l){var p=l.parentNode;return p.nodeType==1?p:null}function K(l){for(var p=0;l=l.previousSibling;)++p;return p}function j(l){switch(l.nodeType){case 7:case 10:return 0;case 3:case 8:return l.length;default:return l.childNodes.length}}function Ce(l,p){var k=[],D;for(D=l;D;D=D.parentNode)k.push(D);for(D=p;D;D=D.parentNode)if(re(k,D))return D;return null}function se(l,p,k){for(var D=k?p:p.parentNode;D;){if(D===l)return!0;D=D.parentNode}return!1}function me(l,p){return se(l,p,!0)}function ee(l,p,k){for(var D,oe=k?l:l.parentNode;oe;){if(D=oe.parentNode,D===p)return oe;oe=D}return null}function Se(l){var p=l.nodeType;return p==3||p==4||p==8}function m(l){if(!l)return!1;var p=l.nodeType;return p==3||p==8}function z(l,p){var k=p.nextSibling,D=p.parentNode;return k?D.insertBefore(l,k):D.appendChild(l),l}function A(l,p,k){var D=l.cloneNode(!1);if(D.deleteData(0,p),l.deleteData(p,l.length-p),z(D,l),k)for(var oe=0,n;n=k[oe++];)n.node==l&&n.offset>p?(n.node=D,n.offset-=p):n.node==l.parentNode&&n.offset>K(l)&&++n.offset;return D}function Q(l){if(l.nodeType==9)return l;if(typeof l.ownerDocument!=v)return l.ownerDocument;if(typeof l.document!=v)return l.document;if(l.parentNode)return Q(l.parentNode);throw C.createError("getDocument: no document found for node")}function ae(l){var p=Q(l);if(typeof p.defaultView!=v)return p.defaultView;if(typeof p.parentWindow!=v)return p.parentWindow;throw C.createError("Cannot get a window object for node")}function G(l){if(typeof l.contentDocument!=v)return l.contentDocument;if(typeof l.contentWindow!=v)return l.contentWindow.document;throw C.createError("getIframeDocument: No Document object found for iframe element")}function H(l){if(typeof l.contentWindow!=v)return l.contentWindow;if(typeof l.contentDocument!=v)return l.contentDocument.defaultView;throw C.createError("getIframeWindow: No Window object found for iframe element")}function ne(l){return l&&w.isHostMethod(l,"setTimeout")&&w.isHostObject(l,"document")}function X(l,p,k){var D;if(l?w.isHostProperty(l,"nodeType")?D=l.nodeType==1&&l.tagName.toLowerCase()=="iframe"?G(l):Q(l):ne(l)&&(D=l.document):D=document,!D)throw p.createError(k+"(): Parameter must be a Window object or DOM node");return D}function Y(l){for(var p;p=l.parentNode;)l=p;return l}function he(l,p,k,D){var oe,n,r,i,s;if(l==k)return p===D?0:p<D?-1:1;if(oe=ee(k,l,!0))return p<=K(oe)?-1:1;if(oe=ee(l,k,!0))return K(oe)<D?-1:1;if(n=Ce(l,k),!n)throw new Error("comparePoints error: nodes have no common ancestor");if(r=l===n?n:ee(l,n,!0),i=k===n?n:ee(k,n,!0),r===i)throw C.createError("comparePoints got to case 4 and childA and childB are the same!");for(s=n.firstChild;s;){if(s===r)return-1;if(s===i)return 1;s=s.nextSibling}}var y=!1;function B(l){var p;try{return p=l.parentNode,!1}catch{return!0}}(function(){var l=document.createElement("b");l.innerHTML="1";var p=l.firstChild;l.innerHTML="<br />",y=B(p),c.features.crashyTextNodes=y})();function q(l){if(!l)return"[No node]";if(y&&B(l))return"[Broken node]";if(Se(l))return'"'+l.data+'"';if(l.nodeType==1){var p=l.id?' id="'+l.id+'"':"";return"<"+l.nodeName+p+">[index:"+K(l)+",length:"+l.childNodes.length+"]["+(l.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return l.nodeName}function J(l){for(var p=Q(l).createDocumentFragment(),k;k=l.firstChild;)p.appendChild(k);return p}var le;typeof window.getComputedStyle!=v?le=function(l,p){return ae(l).getComputedStyle(l,null)[p]}:typeof document.documentElement.currentStyle!=v?le=function(l,p){return l.currentStyle?l.currentStyle[p]:""}:C.fail("No means of obtaining computed style properties found");function ye(l,p,k){var D=x(l),oe=l.createElement("div");oe.contentEditable=""+!!k,p&&(oe.innerHTML=p);var n=D.firstChild;return n?D.insertBefore(oe,n):D.appendChild(oe),oe}function ge(l){return l.parentNode.removeChild(l)}function Re(l){this.root=l,this._next=l}Re.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var l=this._current=this._next,p,k;if(this._current)if(p=l.firstChild,p)this._next=p;else{for(k=null;l!==this.root&&!(k=l.nextSibling);)l=l.parentNode;this._next=k}return this._current},detach:function(){this._current=this._next=this.root=null}};function pe(l){return new Re(l)}function Ne(l,p){this.node=l,this.offset=p}Ne.prototype={equals:function(l){return!!l&&this.node===l.node&&this.offset==l.offset},inspect:function(){return"[DomPosition("+q(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function Te(l){this.code=this[l],this.codeName=l,this.message="DOMException: "+this.codeName}Te.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},Te.prototype.toString=function(){return this.message},c.dom={arrayContains:re,isHtmlNamespace:ce,parentElement:de,getNodeIndex:K,getNodeLength:j,getCommonAncestor:Ce,isAncestorOf:se,isOrIsAncestorOf:me,getClosestAncestorIn:ee,isCharacterDataNode:Se,isTextOrCommentNode:m,insertAfter:z,splitDataNode:A,getDocument:Q,getWindow:ae,getIframeWindow:H,getIframeDocument:G,getBody:x,isWindow:ne,getContentDocument:X,getRootContainer:Y,comparePoints:he,isBrokenNode:B,inspectNode:q,getComputedStyleProperty:le,createTestElement:ye,removeNode:ge,fragmentFromNodeChildren:J,createIterator:pe,DomPosition:Ne},c.DOMException=Te}),V.createCoreModule("DomRange",["DomUtil"],function(c,C){var v=c.dom,w=c.util,x=v.DomPosition,M=c.DOMException,L=v.isCharacterDataNode,re=v.getNodeIndex,ce=v.isOrIsAncestorOf,de=v.getDocument,K=v.comparePoints,j=v.splitDataNode,Ce=v.getClosestAncestorIn,se=v.getNodeLength,me=v.arrayContains,ee=v.getRootContainer,Se=c.features.crashyTextNodes,m=v.removeNode;function z(t,a){return t.nodeType!=3&&(ce(t,a.startContainer)||ce(t,a.endContainer))}function A(t){return t.document||de(t.startContainer)}function Q(t){return ee(t.startContainer)}function ae(t){return new x(t.parentNode,re(t))}function G(t){return new x(t.parentNode,re(t)+1)}function H(t,a,h){var E=t.nodeType==11?t.firstChild:t;return L(a)?h==a.length?v.insertAfter(t,a):a.parentNode.insertBefore(t,h==0?a:j(a,h)):h>=a.childNodes.length?a.appendChild(t):a.insertBefore(t,a.childNodes[h]),E}function ne(t,a,h){if(d(t),d(a),A(a)!=A(t))throw new M("WRONG_DOCUMENT_ERR");var E=K(t.startContainer,t.startOffset,a.endContainer,a.endOffset),P=K(t.endContainer,t.endOffset,a.startContainer,a.startOffset);return h?E<=0&&P>=0:E<0&&P>0}function X(t){for(var a,h,E=A(t.range).createDocumentFragment(),P;h=t.next();){if(a=t.isPartiallySelectedSubtree(),h=h.cloneNode(!a),a&&(P=t.getSubtreeIterator(),h.appendChild(X(P)),P.detach()),h.nodeType==10)throw new M("HIERARCHY_REQUEST_ERR");E.appendChild(h)}return E}function Y(t,a,h){var E,P;h=h||{stop:!1};for(var $,N;$=t.next();)if(t.isPartiallySelectedSubtree()){if(a($)===!1){h.stop=!0;return}else if(N=t.getSubtreeIterator(),Y(N,a,h),N.detach(),h.stop)return}else for(E=v.createIterator($);P=E.next();)if(a(P)===!1){h.stop=!0;return}}function he(t){for(var a;t.next();)t.isPartiallySelectedSubtree()?(a=t.getSubtreeIterator(),he(a),a.detach()):t.remove()}function y(t){for(var a,h=A(t.range).createDocumentFragment(),E;a=t.next();){if(t.isPartiallySelectedSubtree()?(a=a.cloneNode(!1),E=t.getSubtreeIterator(),a.appendChild(y(E)),E.detach()):t.remove(),a.nodeType==10)throw new M("HIERARCHY_REQUEST_ERR");h.appendChild(a)}return h}function B(t,a,h){var E=!!(a&&a.length),P,$=!!h;E&&(P=new RegExp("^("+a.join("|")+")$"));var N=[];return Y(new J(t,!1),function(O){if(!(E&&!P.test(O.nodeType))&&!($&&!h(O))){var b=t.startContainer;if(!(O==b&&L(b)&&t.startOffset==b.length)){var U=t.endContainer;O==U&&L(U)&&t.endOffset==0||N.push(O)}}}),N}function q(t){var a=typeof t.getName>"u"?"Range":t.getName();return"["+a+"("+v.inspectNode(t.startContainer)+":"+t.startOffset+", "+v.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function J(t,a){if(this.range=t,this.clonePartiallySelectedTextNodes=a,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var h=t.commonAncestorContainer;this.sc===this.ec&&L(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===h&&!L(this.sc)?this.sc.childNodes[this.so]:Ce(this.sc,h,!0),this._last=this.ec===h&&!L(this.ec)?this.ec.childNodes[this.eo-1]:Ce(this.ec,h,!0))}}J.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,L(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t=this._current,a,h;L(t)&&(t===this.sc||t===this.ec)?(a=t===this.sc?this.so:0,h=t===this.ec?this.eo:t.length,a!=h&&t.deleteData(a,h-a)):t.parentNode&&m(t)},isPartiallySelectedSubtree:function(){var t=this._current;return z(t,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)t=this.range.cloneRange(),t.collapse(!1);else{t=new ve(A(this.range));var a=this._current,h=a,E=0,P=a,$=se(a);ce(a,this.sc)&&(h=this.sc,E=this.so),ce(a,this.ec)&&(P=this.ec,$=this.eo),Z(t,h,E,P,$)}return new J(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var le=[1,3,4,5,7,8,10],ye=[2,9,11],ge=[5,6,10,12],Re=[1,3,4,5,7,8,10,11],pe=[1,3,4,5,7,8];function Ne(t){return function(a,h){for(var E,P=h?a:a.parentNode;P;){if(E=P.nodeType,me(t,E))return P;P=P.parentNode}return null}}var Te=Ne([9,11]),l=Ne(ge),p=Ne([6,10,12]),k=Ne([1]);function D(t,a){if(p(t,a))throw new M("INVALID_NODE_TYPE_ERR")}function oe(t,a){if(!me(a,t.nodeType))throw new M("INVALID_NODE_TYPE_ERR")}function n(t,a){if(a<0||a>(L(t)?t.length:t.childNodes.length))throw new M("INDEX_SIZE_ERR")}function r(t,a){if(Te(t,!0)!==Te(a,!0))throw new M("WRONG_DOCUMENT_ERR")}function i(t){if(l(t,!0))throw new M("NO_MODIFICATION_ALLOWED_ERR")}function s(t,a){if(!t)throw new M(a)}function u(t,a){return a<=(L(t)?t.length:t.childNodes.length)}function f(t){return!!t.startContainer&&!!t.endContainer&&!(Se&&(v.isBrokenNode(t.startContainer)||v.isBrokenNode(t.endContainer)))&&ee(t.startContainer)==ee(t.endContainer)&&u(t.startContainer,t.startOffset)&&u(t.endContainer,t.endOffset)}function d(t){if(!f(t))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+t.inspect()+")")}var R=document.createElement("style"),_=!1;try{R.innerHTML="<b>x</b>",_=R.firstChild.nodeType==3}catch{}c.features.htmlParsingConforms=_;var I=_?function(t){var a=this.startContainer,h=de(a);if(!a)throw new M("INVALID_STATE_ERR");var E=null;return a.nodeType==1?E=a:L(a)&&(E=v.parentElement(a)),E===null||E.nodeName=="HTML"&&v.isHtmlNamespace(de(E).documentElement)&&v.isHtmlNamespace(E)?E=h.createElement("body"):E=E.cloneNode(!1),E.innerHTML=t,v.fragmentFromNodeChildren(E)}:function(t){var a=A(this),h=a.createElement("body");return h.innerHTML=t,v.fragmentFromNodeChildren(h)};function W(t,a){d(t);var h=t.startContainer,E=t.startOffset,P=t.endContainer,$=t.endOffset,N=h===P;L(P)&&$>0&&$<P.length&&j(P,$,a),L(h)&&E>0&&E<h.length&&(h=j(h,E,a),N?($-=E,P=h):P==h.parentNode&&$>=re(h)&&$++,E=0),t.setStartAndEnd(h,E,P,$)}function S(t){d(t);var a=t.commonAncestorContainer.parentNode.cloneNode(!1);return a.appendChild(t.cloneContents()),a.innerHTML}var te=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ie=0,we=1,Be=2,Ae=3,be=0,Me=1,je=2,qe=3;w.extend(c.rangePrototype,{compareBoundaryPoints:function(t,a){d(this),r(this.startContainer,a.startContainer);var h,E,P,$,N=t==Ae||t==ie?"start":"end",O=t==we||t==ie?"start":"end";return h=this[N+"Container"],E=this[N+"Offset"],P=a[O+"Container"],$=a[O+"Offset"],K(h,E,P,$)},insertNode:function(t){if(d(this),oe(t,Re),i(this.startContainer),ce(t,this.startContainer))throw new M("HIERARCHY_REQUEST_ERR");var a=H(t,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){d(this);var t,a;if(this.collapsed)return A(this).createDocumentFragment();if(this.startContainer===this.endContainer&&L(this.startContainer))return t=this.startContainer.cloneNode(!0),t.data=t.data.slice(this.startOffset,this.endOffset),a=A(this).createDocumentFragment(),a.appendChild(t),a;var h=new J(this,!0);return t=X(h),h.detach(),t},canSurroundContents:function(){d(this),i(this.startContainer),i(this.endContainer);var t=new J(this,!0),a=t._first&&z(t._first,this)||t._last&&z(t._last,this);return t.detach(),!a},surroundContents:function(t){if(oe(t,pe),!this.canSurroundContents())throw new M("INVALID_STATE_ERR");var a=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);H(t,this.startContainer,this.startOffset),t.appendChild(a),this.selectNode(t)},cloneRange:function(){d(this);for(var t=new ve(A(this)),a=te.length,h;a--;)h=te[a],t[h]=this[h];return t},toString:function(){d(this);var t=this.startContainer;if(t===this.endContainer&&L(t))return t.nodeType==3||t.nodeType==4?t.data.slice(this.startOffset,this.endOffset):"";var a=[],h=new J(this,!0);return Y(h,function(E){(E.nodeType==3||E.nodeType==4)&&a.push(E.data)}),h.detach(),a.join("")},compareNode:function(t){d(this);var a=t.parentNode,h=re(t);if(!a)throw new M("NOT_FOUND_ERR");var E=this.comparePoint(a,h),P=this.comparePoint(a,h+1);return E<0?P>0?je:be:P>0?Me:qe},comparePoint:function(t,a){return d(this),s(t,"HIERARCHY_REQUEST_ERR"),r(t,this.startContainer),K(t,a,this.startContainer,this.startOffset)<0?-1:K(t,a,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:I,toHtml:function(){return S(this)},intersectsNode:function(t,a){if(d(this),ee(t)!=Q(this))return!1;var h=t.parentNode,E=re(t);if(!h)return!0;var P=K(h,E,this.endContainer,this.endOffset),$=K(h,E+1,this.startContainer,this.startOffset);return a?P<=0&&$>=0:P<0&&$>0},isPointInRange:function(t,a){return d(this),s(t,"HIERARCHY_REQUEST_ERR"),r(t,this.startContainer),K(t,a,this.startContainer,this.startOffset)>=0&&K(t,a,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return ne(this,t,!1)},intersectsOrTouchesRange:function(t){return ne(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var a=K(this.startContainer,this.startOffset,t.startContainer,t.startOffset),h=K(this.endContainer,this.endOffset,t.endContainer,t.endOffset),E=this.cloneRange();return a==-1&&E.setStart(t.startContainer,t.startOffset),h==1&&E.setEnd(t.endContainer,t.endOffset),E}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var a=this.cloneRange();return K(t.startContainer,t.startOffset,this.startContainer,this.startOffset)==-1&&a.setStart(t.startContainer,t.startOffset),K(t.endContainer,t.endOffset,this.endContainer,this.endOffset)==1&&a.setEnd(t.endContainer,t.endOffset),a}else throw new M("Ranges do not intersect")},containsNode:function(t,a){return a?this.intersectsNode(t,!1):this.compareNode(t)==qe},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,se(t))<=0},containsRange:function(t){var a=this.intersection(t);return a!==null&&t.equals(a)},containsNodeText:function(t){var a=this.cloneRange();a.selectNode(t);var h=a.getNodes([3]);if(h.length>0){a.setStart(h[0],0);var E=h.pop();return a.setEnd(E,E.length),this.containsRange(a)}else return this.containsNodeContents(t)},getNodes:function(t,a){return d(this),B(this,t,a)},getDocument:function(){return A(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(t){var a=A(this),h=c.createRange(a);t=t||v.getBody(a),h.selectNodeContents(t);var E=this.intersection(h),P=0,$=0;return E&&(h.setEnd(E.startContainer,E.startOffset),P=h.toString().length,$=P+E.toString().length),{start:P,end:$,containerNode:t}},moveToBookmark:function(t){var a=t.containerNode,h=0;this.setStart(a,0),this.collapse(!0);for(var E=[a],P,$=!1,N=!1,O,b,U;!N&&(P=E.pop());)if(P.nodeType==3)O=h+P.length,!$&&t.start>=h&&t.start<=O&&(this.setStart(P,t.start-h),$=!0),$&&t.end>=h&&t.end<=O&&(this.setEnd(P,t.end-h),N=!0),h=O;else for(U=P.childNodes,b=U.length;b--;)E.push(U[b])},getName:function(){return"DomRange"},equals:function(t){return ve.rangesEqual(this,t)},isValid:function(){return f(this)},inspect:function(){return q(this)},detach:function(){}});function e(t){t.START_TO_START=ie,t.START_TO_END=we,t.END_TO_END=Be,t.END_TO_START=Ae,t.NODE_BEFORE=be,t.NODE_AFTER=Me,t.NODE_BEFORE_AND_AFTER=je,t.NODE_INSIDE=qe}function o(t){e(t),e(t.prototype)}function g(t,a){return function(){d(this);var h=this.startContainer,E=this.startOffset,P=this.commonAncestorContainer,$=new J(this,!0),N,O;h!==P&&(N=Ce(h,P,!0),O=G(N),h=O.node,E=O.offset),Y($,i),$.reset();var b=t($);return $.detach(),a(this,h,E,h,E),b}}function T(t,a){function h(N,O){return function(b){oe(b,le),oe(ee(b),ye);var U=(N?ae:G)(b);(O?E:P)(this,U.node,U.offset)}}function E(N,O,b){var U=N.endContainer,_e=N.endOffset;(O!==N.startContainer||b!==N.startOffset)&&((ee(O)!=ee(U)||K(O,b,U,_e)==1)&&(U=O,_e=b),a(N,O,b,U,_e))}function P(N,O,b){var U=N.startContainer,_e=N.startOffset;(O!==N.endContainer||b!==N.endOffset)&&((ee(O)!=ee(U)||K(O,b,U,_e)==-1)&&(U=O,_e=b),a(N,U,_e,O,b))}var $=function(){};$.prototype=c.rangePrototype,t.prototype=new $,w.extend(t.prototype,{setStart:function(N,O){D(N,!0),n(N,O),E(this,N,O)},setEnd:function(N,O){D(N,!0),n(N,O),P(this,N,O)},setStartAndEnd:function(){var N=arguments,O=N[0],b=N[1],U=O,_e=b;switch(N.length){case 3:_e=N[2];break;case 4:U=N[2],_e=N[3];break}D(O,!0),n(O,b),D(U,!0),n(U,_e),a(this,O,b,U,_e)},setBoundary:function(N,O,b){this["set"+(b?"Start":"End")](N,O)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(N){d(this),N?a(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):a(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(N){D(N,!0),a(this,N,0,N,se(N))},selectNode:function(N){D(N,!1),oe(N,le);var O=ae(N),b=G(N);a(this,O.node,O.offset,b.node,b.offset)},extractContents:g(y,a),deleteContents:g(he,a),canSurroundContents:function(){d(this),i(this.startContainer),i(this.endContainer);var N=new J(this,!0),O=N._first&&z(N._first,this)||N._last&&z(N._last,this);return N.detach(),!O},splitBoundaries:function(){W(this)},splitBoundariesPreservingPositions:function(N){W(this,N)},normalizeBoundaries:function(){d(this);var N=this.startContainer,O=this.startOffset,b=this.endContainer,U=this.endOffset,_e=function(De){var ze=De.nextSibling;ze&&ze.nodeType==De.nodeType&&(b=De,U=De.length,De.appendData(ze.data),m(ze))},Tt=function(De){var ze=De.previousSibling;if(ze&&ze.nodeType==De.nodeType){N=De;var _t=De.length;if(O=ze.length,De.insertData(0,ze.data),m(ze),N==b)U+=O,b=N;else if(b==De.parentNode){var wt=re(De);U==wt?(b=De,U=_t):U>wt&&U--}}},Nt=!0,Le;if(L(b))U==b.length?_e(b):U==0&&(Le=b.previousSibling,Le&&Le.nodeType==b.nodeType&&(U=Le.length,N==b&&(Nt=!1),Le.appendData(b.data),m(b),b=Le));else{if(U>0){var St=b.childNodes[U-1];St&&L(St)&&_e(St)}Nt=!this.collapsed}if(Nt){if(L(N))O==0?Tt(N):O==N.length&&(Le=N.nextSibling,Le&&Le.nodeType==N.nodeType&&(b==Le&&(b=N,U+=N.length),N.appendData(Le.data),m(Le)));else if(O<N.childNodes.length){var Et=N.childNodes[O];Et&&L(Et)&&Tt(Et)}}else N=b,O=U;a(this,N,O,b,U)},collapseToPoint:function(N,O){D(N,!0),n(N,O),this.setStartAndEnd(N,O)},parentElement:function(){d(this);var N=this.commonAncestorContainer;return N?k(this.commonAncestorContainer,!0):null}}),o(t)}function F(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:v.getCommonAncestor(t.startContainer,t.endContainer)}function Z(t,a,h,E,P){t.startContainer=a,t.startOffset=h,t.endContainer=E,t.endOffset=P,t.document=v.getDocument(a),F(t)}function ve(t){Z(this,t,0,t,0)}T(ve,Z),w.extend(ve,{rangeProperties:te,RangeIterator:J,copyComparisonConstants:o,createPrototypeRange:T,inspect:q,toHtml:S,getRangeDocument:A,rangesEqual:function(t,a){return t.startContainer===a.startContainer&&t.startOffset===a.startOffset&&t.endContainer===a.endContainer&&t.endOffset===a.endOffset}}),c.DomRange=ve}),V.createCoreModule("WrappedRange",["DomRange"],function(c,C){var v,w,x=c.dom,M=c.util,L=x.DomPosition,re=c.DomRange,ce=x.getBody,de=x.getContentDocument,K=x.isCharacterDataNode;if(c.features.implementsDomRange&&function(){var m,z=re.rangeProperties;function A(y){for(var B=z.length,q;B--;)q=z[B],y[q]=y.nativeRange[q];y.collapsed=y.startContainer===y.endContainer&&y.startOffset===y.endOffset}function Q(y,B,q,J,le){var ye=y.startContainer!==B||y.startOffset!=q,ge=y.endContainer!==J||y.endOffset!=le,Re=!y.equals(y.nativeRange);(ye||ge||Re)&&(y.setEnd(J,le),y.setStart(B,q))}var ae;v=function(y){if(!y)throw C.createError("WrappedRange: Range must be specified");this.nativeRange=y,A(this)},re.createPrototypeRange(v,Q),m=v.prototype,m.selectNode=function(y){this.nativeRange.selectNode(y),A(this)},m.cloneContents=function(){return this.nativeRange.cloneContents()},m.surroundContents=function(y){this.nativeRange.surroundContents(y),A(this)},m.collapse=function(y){this.nativeRange.collapse(y),A(this)},m.cloneRange=function(){return new v(this.nativeRange.cloneRange())},m.refresh=function(){A(this)},m.toString=function(){return this.nativeRange.toString()};var G=document.createTextNode("test");ce(document).appendChild(G);var H=document.createRange();H.setStart(G,0),H.setEnd(G,0);try{H.setStart(G,1),m.setStart=function(y,B){this.nativeRange.setStart(y,B),A(this)},m.setEnd=function(y,B){this.nativeRange.setEnd(y,B),A(this)},ae=function(y){return function(B){this.nativeRange[y](B),A(this)}}}catch{m.setStart=function(B,q){try{this.nativeRange.setStart(B,q)}catch{this.nativeRange.setEnd(B,q),this.nativeRange.setStart(B,q)}A(this)},m.setEnd=function(B,q){try{this.nativeRange.setEnd(B,q)}catch{this.nativeRange.setStart(B,q),this.nativeRange.setEnd(B,q)}A(this)},ae=function(B,q){return function(J){try{this.nativeRange[B](J)}catch{this.nativeRange[q](J),this.nativeRange[B](J)}A(this)}}}m.setStartBefore=ae("setStartBefore","setEndBefore"),m.setStartAfter=ae("setStartAfter","setEndAfter"),m.setEndBefore=ae("setEndBefore","setStartBefore"),m.setEndAfter=ae("setEndAfter","setStartAfter"),m.selectNodeContents=function(y){this.setStartAndEnd(y,0,x.getNodeLength(y))},H.selectNodeContents(G),H.setEnd(G,3);var ne=document.createRange();ne.selectNodeContents(G),ne.setEnd(G,4),ne.setStart(G,2),H.compareBoundaryPoints(H.START_TO_END,ne)==-1&&H.compareBoundaryPoints(H.END_TO_START,ne)==1?m.compareBoundaryPoints=function(y,B){return B=B.nativeRange||B,y==B.START_TO_END?y=B.END_TO_START:y==B.END_TO_START&&(y=B.START_TO_END),this.nativeRange.compareBoundaryPoints(y,B)}:m.compareBoundaryPoints=function(y,B){return this.nativeRange.compareBoundaryPoints(y,B.nativeRange||B)};var X=document.createElement("div");X.innerHTML="123";var Y=X.firstChild,he=ce(document);he.appendChild(X),H.setStart(Y,1),H.setEnd(Y,2),H.deleteContents(),Y.data=="13"&&(m.deleteContents=function(){this.nativeRange.deleteContents(),A(this)},m.extractContents=function(){var y=this.nativeRange.extractContents();return A(this),y}),he.removeChild(X),he=null,M.isHostMethod(H,"createContextualFragment")&&(m.createContextualFragment=function(y){return this.nativeRange.createContextualFragment(y)}),ce(document).removeChild(G),m.getName=function(){return"WrappedRange"},c.WrappedRange=v,c.createNativeRange=function(y){return y=de(y,C,"createNativeRange"),y.createRange()}}(),c.features.implementsTextRange){var j=function(m){var z=m.parentElement(),A=m.duplicate();A.collapse(!0);var Q=A.parentElement();A=m.duplicate(),A.collapse(!1);var ae=A.parentElement(),G=Q==ae?Q:x.getCommonAncestor(Q,ae);return G==z?G:x.getCommonAncestor(z,G)},Ce=function(m){return m.compareEndPoints("StartToEnd",m)==0},se=function(m,z,A,Q,ae){var G=m.duplicate();G.collapse(A);var H=G.parentElement();if(x.isOrIsAncestorOf(z,H)||(H=z),!H.canHaveHTML){var ne=new L(H.parentNode,x.getNodeIndex(H));return{boundaryPosition:ne,nodeInfo:{nodeIndex:ne.offset,containerElement:ne.node}}}var X=x.getDocument(H).createElement("span");X.parentNode&&x.removeNode(X);for(var Y,he=A?"StartToStart":"StartToEnd",y,B,q,J,le=ae&&ae.containerElement==H?ae.nodeIndex:0,ye=H.childNodes.length,ge=ye,Re=ge;Re==ye?H.appendChild(X):H.insertBefore(X,H.childNodes[Re]),G.moveToElementText(X),Y=G.compareEndPoints(he,m),!(Y==0||le==ge);){if(Y==-1){if(ge==le+1)break;le=Re}else ge=ge==le+1?le:Re;Re=Math.floor((le+ge)/2),H.removeChild(X)}if(J=X.nextSibling,Y==-1&&J&&K(J)){G.setEndPoint(A?"EndToStart":"EndToEnd",m);var pe;if(/[\r\n]/.test(J.data)){var Ne=G.duplicate(),Te=Ne.text.replace(/\r\n/g,"\r").length;for(pe=Ne.moveStart("character",Te);(Y=Ne.compareEndPoints("StartToEnd",Ne))==-1;)pe++,Ne.moveStart("character",1)}else pe=G.text.length;q=new L(J,pe)}else y=(Q||!A)&&X.previousSibling,B=(Q||A)&&X.nextSibling,B&&K(B)?q=new L(B,0):y&&K(y)?q=new L(y,y.data.length):q=new L(H,x.getNodeIndex(X));return x.removeNode(X),{boundaryPosition:q,nodeInfo:{nodeIndex:Re,containerElement:H}}},me=function(m,z){var A,Q,ae=m.offset,G=x.getDocument(m.node),H,ne,X=ce(G).createTextRange(),Y=K(m.node);return Y?(A=m.node,Q=A.parentNode):(ne=m.node.childNodes,A=ae<ne.length?ne[ae]:null,Q=m.node),H=G.createElement("span"),H.innerHTML="&#feff;",A?Q.insertBefore(H,A):Q.appendChild(H),X.moveToElementText(H),X.collapse(!z),Q.removeChild(H),Y&&X[z?"moveStart":"moveEnd"]("character",ae),X};w=function(m){this.textRange=m,this.refresh()},w.prototype=new re(document),w.prototype.refresh=function(){var m,z,A,Q=j(this.textRange);Ce(this.textRange)?z=m=se(this.textRange,Q,!0,!0).boundaryPosition:(A=se(this.textRange,Q,!0,!1),m=A.boundaryPosition,z=se(this.textRange,Q,!1,!1,A.nodeInfo).boundaryPosition),this.setStart(m.node,m.offset),this.setEnd(z.node,z.offset)},w.prototype.getName=function(){return"WrappedTextRange"},re.copyComparisonConstants(w);var ee=function(m){if(m.collapsed)return me(new L(m.startContainer,m.startOffset),!0);var z=me(new L(m.startContainer,m.startOffset),!0),A=me(new L(m.endContainer,m.endOffset),!1),Q=ce(re.getRangeDocument(m)).createTextRange();return Q.setEndPoint("StartToStart",z),Q.setEndPoint("EndToEnd",A),Q};if(w.rangeToTextRange=ee,w.prototype.toTextRange=function(){return ee(this)},c.WrappedTextRange=w,!c.features.implementsDomRange||c.config.preferTextRange){var Se=function(m){return m("return this;")()}(Function);typeof Se.Range>"u"&&(Se.Range=w),c.createNativeRange=function(m){return m=de(m,C,"createNativeRange"),ce(m).createTextRange()},c.WrappedRange=w}}c.createRange=function(m){return m=de(m,C,"createRange"),new c.WrappedRange(c.createNativeRange(m))},c.createRangyRange=function(m){return m=de(m,C,"createRangyRange"),new re(m)},M.createAliasForDeprecatedMethod(c,"createIframeRange","createRange"),M.createAliasForDeprecatedMethod(c,"createIframeRangyRange","createRangyRange"),c.addShimListener(function(m){var z=m.document;typeof z.createRange>"u"&&(z.createRange=function(){return c.createRange(z)}),z=m=null})}),V.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(c,C){c.config.checkSelectionRanges=!0;var v="boolean",w="number",x=c.dom,M=c.util,L=M.isHostMethod,re=c.DomRange,ce=c.WrappedRange,de=c.DOMException,K=x.DomPosition,j,Ce,se=c.features,me="Control",ee=x.getDocument,Se=x.getBody,m=re.rangesEqual;function z(e){return typeof e=="string"?/^backward(s)?$/i.test(e):!!e}function A(e,o){if(e){if(x.isWindow(e))return e;if(e instanceof d)return e.win;var g=x.getContentDocument(e,C,o);return x.getWindow(g)}else return window}function Q(e){return A(e,"getWinSelection").getSelection()}function ae(e){return A(e,"getDocSelection").document.selection}function G(e){var o=!1;return e.anchorNode&&(o=x.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),o}var H=L(window,"getSelection"),ne=M.isHostObject(document,"selection");se.implementsWinGetSelection=H,se.implementsDocSelection=ne;var X=ne&&(!H||c.config.preferTextRange);if(X)j=ae,c.isSelectionValid=function(e){var o=A(e,"isSelectionValid").document,g=o.selection;return g.type!="None"||ee(g.createRange().parentElement())==o};else if(H)j=Q,c.isSelectionValid=function(){return!0};else return C.fail("Neither document.selection or window.getSelection() detected."),!1;c.getNativeSelection=j;var Y=j();if(!Y)return C.fail("Native selection was null (possibly issue 138?)"),!1;var he=c.createNativeRange(document),y=Se(document),B=M.areHostProperties(Y,["anchorNode","focusNode","anchorOffset","focusOffset"]);se.selectionHasAnchorAndFocus=B;var q=L(Y,"extend");se.selectionHasExtend=q;var J=L(Y,"setBaseAndExtent");se.selectionHasSetBaseAndExtent=J;var le=typeof Y.rangeCount==w;se.selectionHasRangeCount=le;var ye=!1,ge=!0,Re=q?function(e,o){var g=re.getRangeDocument(o),T=c.createRange(g);T.collapseToPoint(o.endContainer,o.endOffset),e.addRange(D(T)),e.extend(o.startContainer,o.startOffset)}:null;M.areHostMethods(Y,["addRange","getRangeAt","removeAllRanges"])&&typeof Y.rangeCount==w&&se.implementsDomRange&&function(){var e=window.getSelection();if(e){for(var o=e.rangeCount,g=o>1,T=[],F=G(e),Z=0;Z<o;++Z)T[Z]=e.getRangeAt(Z);var ve=x.createTestElement(document,"",!1),t=ve.appendChild(document.createTextNode("   ")),a=document.createRange();if(a.setStart(t,1),a.collapse(!0),e.removeAllRanges(),e.addRange(a),ge=e.rangeCount==1,e.removeAllRanges(),!g){var h=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(h&&parseInt(h[1])>=36)ye=!1;else{var E=a.cloneRange();a.setStart(t,0),E.setEnd(t,3),E.setStart(t,2),e.addRange(a),e.addRange(E),ye=e.rangeCount==2}}for(x.removeNode(ve),e.removeAllRanges(),Z=0;Z<o;++Z)Z==0&&F?Re?Re(e,T[Z]):(c.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(T[Z])):e.addRange(T[Z])}}(),se.selectionSupportsMultipleRanges=ye,se.collapsedNonEditableSelectionsSupported=ge;var pe=!1,Ne;y&&L(y,"createControlRange")&&(Ne=y.createControlRange(),M.areHostProperties(Ne,["item","add"])&&(pe=!0)),se.implementsControlRange=pe,B?Ce=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:Ce=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};function Te(e,o,g){var T=g?"end":"start",F=g?"start":"end";e.anchorNode=o[T+"Container"],e.anchorOffset=o[T+"Offset"],e.focusNode=o[F+"Container"],e.focusOffset=o[F+"Offset"]}function l(e){var o=e.nativeSelection;e.anchorNode=o.anchorNode,e.anchorOffset=o.anchorOffset,e.focusNode=o.focusNode,e.focusOffset=o.focusOffset}function p(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0,k(e)}function k(e){e.type=e.rangeCount==0?"None":Ce(e)?"Caret":"Range"}function D(e){var o;return e instanceof re?(o=c.createNativeRange(e.getDocument()),o.setEnd(e.endContainer,e.endOffset),o.setStart(e.startContainer,e.startOffset)):e instanceof ce?o=e.nativeRange:se.implementsDomRange&&e instanceof x.getWindow(e.startContainer).Range&&(o=e),o}function oe(e){if(!e.length||e[0].nodeType!=1)return!1;for(var o=1,g=e.length;o<g;++o)if(!x.isAncestorOf(e[0],e[o]))return!1;return!0}function n(e){var o=e.getNodes();if(!oe(o))throw C.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return o[0]}function r(e){return!!e&&typeof e.text<"u"}function i(e,o){var g=new ce(o);e._ranges=[g],Te(e,g,!1),e.rangeCount=1,e.isCollapsed=g.collapsed,k(e)}function s(e){if(e._ranges.length=0,e.docSelection.type=="None")p(e);else{var o=e.docSelection.createRange();if(r(o))i(e,o);else{e.rangeCount=o.length;for(var g,T=ee(o.item(0)),F=0;F<e.rangeCount;++F)g=c.createRange(T),g.selectNode(o.item(F)),e._ranges.push(g);e.isCollapsed=e.rangeCount==1&&e._ranges[0].collapsed,Te(e,e._ranges[e.rangeCount-1],!1),k(e)}}}function u(e,o){for(var g=e.docSelection.createRange(),T=n(o),F=ee(g.item(0)),Z=Se(F).createControlRange(),ve=0,t=g.length;ve<t;++ve)Z.add(g.item(ve));try{Z.add(T)}catch{throw C.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}Z.select(),s(e)}var f;L(Y,"getRangeAt")?f=function(e,o){try{return e.getRangeAt(o)}catch{return null}}:B&&(f=function(e){var o=ee(e.anchorNode),g=c.createRange(o);return g.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),g.collapsed!==this.isCollapsed&&g.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),g});function d(e,o,g){this.nativeSelection=e,this.docSelection=o,this._ranges=[],this.win=g,this.refresh()}d.prototype=c.selectionPrototype;function R(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0,k(e)}var _=[];function I(e,o){for(var g=_.length,T,F;g--;)if(T=_[g],F=T.selection,o=="deleteAll")R(F);else if(T.win==e)return o=="delete"?(_.splice(g,1),!0):F;return o=="deleteAll"&&(_.length=0),null}var W=function(e){if(e&&e instanceof d)return e.refresh(),e;e=A(e,"getNativeSelection");var o=I(e),g=j(e),T=ne?ae(e):null;return o?(o.nativeSelection=g,o.docSelection=T,o.refresh()):(o=new d(g,T,e),_.push({win:e,selection:o})),o};c.getSelection=W,M.createAliasForDeprecatedMethod(c,"getIframeSelection","getSelection");var S=d.prototype;function te(e,o){for(var g=ee(o[0].startContainer),T=Se(g).createControlRange(),F=0,Z,ve=o.length;F<ve;++F){Z=n(o[F]);try{T.add(Z)}catch{throw C.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}T.select(),s(e)}if(!X&&B&&M.areHostMethods(Y,["removeAllRanges","addRange"])){S.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),p(this)};var ie=function(e,o){Re(e.nativeSelection,o),e.refresh()};le?S.addRange=function(e,o){if(pe&&ne&&this.docSelection.type==me)u(this,e);else if(z(o)&&q)ie(this,e);else{var g;ye?g=this.rangeCount:(this.removeAllRanges(),g=0);var T=D(e).cloneRange();try{this.nativeSelection.addRange(T)}catch{}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==g+1){if(c.config.checkSelectionRanges){var F=f(this.nativeSelection,this.rangeCount-1);F&&!m(F,e)&&(e=new ce(F))}this._ranges[this.rangeCount-1]=e,Te(this,e,Ae(this.nativeSelection)),this.isCollapsed=Ce(this),k(this)}else this.refresh()}}:S.addRange=function(e,o){z(o)&&q?ie(this,e):(this.nativeSelection.addRange(D(e)),this.refresh())},S.setRanges=function(e){if(pe&&ne&&e.length>1)te(this,e);else{this.removeAllRanges();for(var o=0,g=e.length;o<g;++o)this.addRange(e[o])}}}else if(L(Y,"empty")&&L(he,"select")&&pe&&X)S.removeAllRanges=function(){try{if(this.docSelection.empty(),this.docSelection.type!="None"){var e;if(this.anchorNode)e=ee(this.anchorNode);else if(this.docSelection.type==me){var o=this.docSelection.createRange();o.length&&(e=ee(o.item(0)))}if(e){var g=Se(e).createTextRange();g.select(),this.docSelection.empty()}}}catch{}p(this)},S.addRange=function(e){this.docSelection.type==me?u(this,e):(c.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,Te(this,e,!1),k(this))},S.setRanges=function(e){this.removeAllRanges();var o=e.length;o>1?te(this,e):o&&this.addRange(e[0])};else return C.fail("No means of selecting a Range or TextRange was found"),!1;S.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new de("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var we;if(X)we=function(e){var o;c.isSelectionValid(e.win)?o=e.docSelection.createRange():(o=Se(e.win.document).createTextRange(),o.collapse(!0)),e.docSelection.type==me?s(e):r(o)?i(e,o):p(e)};else if(L(Y,"getRangeAt")&&typeof Y.rangeCount==w)we=function(e){if(pe&&ne&&e.docSelection.type==me)s(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var o=0,g=e.rangeCount;o<g;++o)e._ranges[o]=new c.WrappedRange(e.nativeSelection.getRangeAt(o));Te(e,e._ranges[e.rangeCount-1],Ae(e.nativeSelection)),e.isCollapsed=Ce(e),k(e)}else p(e)};else if(B&&typeof Y.isCollapsed==v&&typeof he.collapsed==v&&se.implementsDomRange)we=function(e){var o,g=e.nativeSelection;g.anchorNode?(o=f(g,0),e._ranges=[o],e.rangeCount=1,l(e),e.isCollapsed=Ce(e),k(e)):p(e)};else return C.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;S.refresh=function(e){var o=e?this._ranges.slice(0):null,g=this.anchorNode,T=this.anchorOffset;if(we(this),e){var F=o.length;if(F!=this._ranges.length||this.anchorNode!=g||this.anchorOffset!=T)return!0;for(;F--;)if(!m(o[F],this._ranges[F]))return!0;return!1}};var Be=function(e,o){var g=e.getAllRanges();e.removeAllRanges();for(var T=0,F=g.length;T<F;++T)m(o,g[T])||e.addRange(g[T]);e.rangeCount||p(e)};pe&&ne?S.removeRange=function(e){if(this.docSelection.type==me){for(var o=this.docSelection.createRange(),g=n(e),T=ee(o.item(0)),F=Se(T).createControlRange(),Z,ve=!1,t=0,a=o.length;t<a;++t)Z=o.item(t),Z!==g||ve?F.add(o.item(t)):ve=!0;F.select(),s(this)}else Be(this,e)}:S.removeRange=function(e){Be(this,e)};var Ae;!X&&B&&se.implementsDomRange?(Ae=G,S.isBackward=function(){return Ae(this)}):Ae=S.isBackward=function(){return!1},S.isBackwards=S.isBackward,S.toString=function(){for(var e=[],o=0,g=this.rangeCount;o<g;++o)e[o]=""+this._ranges[o];return e.join("")};function be(e,o){if(e.win.document!=ee(o))throw new de("WRONG_DOCUMENT_ERR")}function Me(e,o){if(o<0||o>(x.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new de("INDEX_SIZE_ERR")}S.collapse=function(e,o){be(this,e);var g=c.createRange(e);g.collapseToPoint(e,o),this.setSingleRange(g),this.isCollapsed=!0},S.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else throw new de("INVALID_STATE_ERR")},S.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else throw new de("INVALID_STATE_ERR")},S.selectAllChildren=function(e){be(this,e);var o=c.createRange(e);o.selectNodeContents(e),this.setSingleRange(o)},J?S.setBaseAndExtent=function(e,o,g,T){this.nativeSelection.setBaseAndExtent(e,o,g,T),this.refresh()}:q&&(S.setBaseAndExtent=function(e,o,g,T){Me(e,o),Me(g,T),be(this,e),be(this,g);var F=c.createRange(node),Z=x.comparePoints(e,o,g,T)==-1;Z?F.setStartAndEnd(g,T,e,o):F.setStartAndEnd(e,o,g,T),this.setSingleRange(F,Z)}),S.deleteFromDocument=function(){if(pe&&ne&&this.docSelection.type==me){for(var e=this.docSelection.createRange(),o;e.length;)o=e.item(0),e.remove(o),x.removeNode(o);this.refresh()}else if(this.rangeCount){var g=this.getAllRanges();if(g.length){this.removeAllRanges();for(var T=0,F=g.length;T<F;++T)g[T].deleteContents();this.addRange(g[F-1])}}},S.eachRange=function(e,o){for(var g=0,T=this._ranges.length;g<T;++g)if(e(this.getRangeAt(g)))return o},S.getAllRanges=function(){var e=[];return this.eachRange(function(o){e.push(o)}),e},S.setSingleRange=function(e,o){this.removeAllRanges(),this.addRange(e,o)},S.callMethodOnEachRange=function(e,o){var g=[];return this.eachRange(function(T){g.push(T[e].apply(T,o||[]))}),g};function je(e){return function(o,g){var T;this.rangeCount?(T=this.getRangeAt(0),T["set"+(e?"Start":"End")](o,g)):(T=c.createRange(this.win.document),T.setStartAndEnd(o,g)),this.setSingleRange(T,this.isBackward())}}S.setStart=je(!0),S.setEnd=je(!1),c.rangePrototype.select=function(e){W(this.getDocument()).setSingleRange(this,e)},S.changeEachRange=function(e){var o=[],g=this.isBackward();this.eachRange(function(T){e(T),o.push(T)}),this.removeAllRanges(),g&&o.length==1?this.addRange(o[0],"backward"):this.setRanges(o)},S.containsNode=function(e,o){return this.eachRange(function(g){return g.containsNode(e,o)},!0)||!1},S.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},S.moveToBookmark=function(e){for(var o=[],g=0,T,F;T=e.rangeBookmarks[g++];)F=c.createRange(this.win),F.moveToBookmark(T),o.push(F);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},S.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},S.restoreRanges=function(e){this.removeAllRanges();for(var o=0,g;g=e.ranges[o];++o)this.addRange(g,e.backward&&o==0)},S.toHtml=function(){var e=[];return this.eachRange(function(o){e.push(re.toHtml(o))}),e.join("")},se.implementsTextRange&&(S.getNativeTextRange=function(){var e;if(e=this.docSelection){var o=e.createRange();if(r(o))return o;throw C.createError("getNativeTextRange: selection is a control selection")}else{if(this.rangeCount>0)return c.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw C.createError("getNativeTextRange: selection contains no range")}});function qe(e){var o=[],g=new K(e.anchorNode,e.anchorOffset),T=new K(e.focusNode,e.focusOffset),F=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount<"u")for(var Z=0,ve=e.rangeCount;Z<ve;++Z)o[Z]=re.inspect(e.getRangeAt(Z));return"["+F+"(Ranges: "+o.join(", ")+")(anchor: "+g.inspect()+", focus: "+T.inspect()+"]"}S.getName=function(){return"WrappedSelection"},S.inspect=function(){return qe(this)},S.detach=function(){I(this.win,"delete"),R(this)},d.detachAll=function(){I(null,"deleteAll")},d.inspect=qe,d.isDirectionBackward=z,c.Selection=d,c.selectionPrototype=S,c.addShimListener(function(e){typeof e.getSelection>"u"&&(e.getSelection=function(){return W(e)}),e=null})});var mt=!1,ft=function(c){mt||(mt=!0,!V.initialized&&V.config.autoInitialize&&lt())};return We&&(document.readyState=="complete"?ft():(Ie(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",ft,!1),Ke(window,"load",ft))),V})}(yt)),yt.exports}(function(Pe,Ue){(function(xe,ue){Pe.exports=xe(Pt())})(function(xe){return xe.createModule("TextRange",["WrappedSelection"],function(ue,fe){var Oe="undefined",He="character",at="word",Ee=ue.dom,Ie=ue.util,ke=Ie.extend,Ge=Ie.createOptions,Qe=Ee.getBody,ot=/^[ \t\f\r\n]+$/,Rt=/^[ \t\f\r]+$/,et=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,dt=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,tt="en",st=ue.Selection.isDirectionBackward,$e=!1,We=!1,Fe=!0;(function(){var n=Ee.createTestElement(document,"<p>1 </p><p></p>",!0),r=n.firstChild,i=ue.getSelection();i.collapse(r.lastChild,2),i.setStart(r.firstChild,0),n.innerHTML="1 <br />",i.collapse(n,2),i.setStart(n.firstChild,0),$e=(""+i).length==1,n.innerHTML="1 <p>1</p>",i.collapse(n,2),i.setStart(n.firstChild,0),We=(""+i).length==1,Ee.removeNode(n),i.removeAllRanges()})();function V(n,r){var i=n.join(""),s,u=[];function f(I,W,S){u.push({start:I,end:W,isWord:S})}for(var d=0,R,_;s=r.wordRegex.exec(i);){if(R=s.index,_=R+s[0].length,R>d&&f(d,R,!1),r.includeTrailingSpace)for(;dt.test(n[_]);)++_;f(R,_,!0),d=_}return d<n.length&&f(d,n.length,!1),u}function nt(n,r){for(var i=n.slice(r.start,r.end),s={isWord:r.isWord,chars:i,toString:function(){return i.join("")}},u=0,f=i.length;u<f;++u)i[u].token=s;return s}function rt(n,r,i){for(var s=i(n,r),u=[],f=0,d;d=s[f++];)u.push(nt(n,d));return u}var Ve={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""};function Ct(n){var r=n||"",i=typeof r=="string"?r.split(""):r;return i.sort(function(s,u){return s.charCodeAt(0)-u.charCodeAt(0)}),i.join("").replace(/(.)\1+/g,"$1")}var it={includeBlockContentTrailingSpace:!Fe,includeSpaceBeforeBr:!$e,includeSpaceBeforeBlock:!We,includePreLineTrailingSpace:!0},Ke={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:V}},ct={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},ht={wordOptions:null,characterOptions:null},lt={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},gt={wordOptions:null,characterOptions:null,direction:"forward"};function pt(n){var r,i;return n?(r=n.language||tt,i={},ke(i,Ke[r]||Ke[tt]),ke(i,n),i):Ke[tt]}function Ye(n,r){var i=Ge(n,r);return r.hasOwnProperty("wordOptions")&&(i.wordOptions=pt(i.wordOptions)),r.hasOwnProperty("characterOptions")&&(i.characterOptions=Ge(i.characterOptions,Ve)),i}var Xe=Ee.getComputedStyleProperty,Ze;(function(){var n=document.createElement("table"),r=Qe(document);r.appendChild(n),Ze=Xe(n,"display")=="block",r.removeChild(n)})();var ut={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};function Je(n,r){var i=Xe(n,"display",r),s=n.tagName.toLowerCase();return i=="block"&&Ze&&ut.hasOwnProperty(s)?ut[s]:i}function vt(n){for(var r=v(n),i=0,s=r.length;i<s;++i)if(r[i].nodeType==1&&Je(r[i])=="none")return!0;return!1}function mt(n){var r;return n.nodeType==3&&(r=n.parentNode)&&Xe(r,"visibility")=="hidden"}function ft(n){return n&&(n.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(Je(n))||n.nodeType==9||n.nodeType==11)}function c(n){return Ee.isCharacterDataNode(n)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(n.nodeName)}function C(n){for(var r=[];n.parentNode;)r.unshift(n.parentNode),n=n.parentNode;return r}function v(n){return C(n).concat([n])}function w(n){for(;n&&!n.nextSibling;)n=n.parentNode;return n?n.nextSibling:null}function x(n,r){return!r&&n.hasChildNodes()?n.firstChild:w(n)}function M(n){var r=n.previousSibling;if(r){for(n=r;n.hasChildNodes();)n=n.lastChild;return n}var i=n.parentNode;return i&&i.nodeType==1?i:null}function L(n){if(!n||n.nodeType!=3)return!1;var r=n.data;if(r==="")return!0;var i=n.parentNode;if(!i||i.nodeType!=1)return!1;var s=Xe(n.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(r)&&/^(normal|nowrap)$/.test(s)||/^[\t\r ]+$/.test(r)&&s=="pre-line"}function re(n){if(n.data==="")return!0;if(!L(n))return!1;var r=n.parentNode;return!!(!r||vt(n))}function ce(n){var r=n.nodeType;return r==7||r==8||vt(n)||/^(script|style)$/i.test(n.nodeName)||mt(n)||re(n)}function de(n,r){var i=n.nodeType;return i==7||i==8||i==1&&Je(n,r)=="none"}function K(){this.store={}}K.prototype={get:function(n){return this.store.hasOwnProperty(n)?this.store[n]:null},set:function(n,r){return this.store[n]=r}};function j(n,r,i){return function(s){var u=this.cache;if(u.hasOwnProperty(n))return u[n];var f=r.call(this,i?this[i]:this,s);return u[n]=f,f}}function Ce(n,r){this.node=n,this.session=r,this.cache=new K,this.positions=new K}var se={getPosition:function(n){var r=this.positions;return r.get(n)||r.set(n,new ne(this,n))},toString:function(){return"[NodeWrapper("+Ee.inspectNode(this.node)+")]"}};Ce.prototype=se;var me="EMPTY",ee="NON_SPACE",Se="UNCOLLAPSIBLE_SPACE",m="COLLAPSIBLE_SPACE",z="TRAILING_SPACE_BEFORE_BLOCK",A="TRAILING_SPACE_IN_BLOCK",Q="TRAILING_SPACE_BEFORE_BR",ae="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",G="TRAILING_LINE_BREAK_AFTER_BR",H="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";ke(se,{isCharacterDataNode:j("isCharacterDataNode",Ee.isCharacterDataNode,"node"),getNodeIndex:j("nodeIndex",Ee.getNodeIndex,"node"),getLength:j("nodeLength",Ee.getNodeLength,"node"),containsPositions:j("containsPositions",c,"node"),isWhitespace:j("isWhitespace",L,"node"),isCollapsedWhitespace:j("isCollapsedWhitespace",re,"node"),getComputedDisplay:j("computedDisplay",Je,"node"),isCollapsed:j("collapsed",ce,"node"),isIgnored:j("ignored",de,"node"),next:j("nextPos",x,"node"),previous:j("previous",M,"node"),getTextNodeInfo:j("textNodeInfo",function(n){var r=null,i=!1,s=Xe(n.parentNode,"whiteSpace"),u=s=="pre-line";return u?(r=Rt,i=!0):(s=="normal"||s=="nowrap")&&(r=ot,i=!0),{node:n,text:n.data,spaceRegex:r,collapseSpaces:i,preLine:u}},"node"),hasInnerText:j("hasInnerText",function(n,r){for(var i=this.session,s=i.getPosition(n.parentNode,this.getNodeIndex()+1),u=i.getPosition(n,0),f=r?s:u,d=r?u:s;f!==d;){if(f.prepopulateChar(),f.isDefinitelyNonEmpty())return!0;f=r?f.previousVisible():f.nextVisible()}return!1},"node"),isRenderedBlock:j("isRenderedBlock",function(n){for(var r=n.getElementsByTagName("br"),i=0,s=r.length;i<s;++i)if(!ce(r[i]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:j("trailingSpace",function(n){if(n.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":for(var r=n.lastChild;r;){if(!de(r))return r.nodeType==1?this.session.getNodeWrapper(r).getTrailingSpace():"";r=r.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.isRenderedBlock(!0)?`
`:""}return""},"node"),getLeadingSpace:j("leadingSpace",function(n){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?`
`:""}return""},"node")});function ne(n,r){this.offset=r,this.nodeWrapper=n,this.node=n.node,this.session=n.session,this.cache=new K}function X(){return"[Position("+Ee.inspectNode(this.node)+":"+this.offset+")]"}var Y={character:"",characterType:me,isBr:!1,prepopulateChar:function(){var n=this;if(!n.prepopulatedChar){var r=n.node,i=n.offset,s="",u=me,f=!1;if(i>0)if(r.nodeType==3){var d=r.data,R=d.charAt(i-1),_=n.nodeWrapper.getTextNodeInfo(),I=_.spaceRegex;_.collapseSpaces?I.test(R)?i>1&&I.test(d.charAt(i-2))||(_.preLine&&d.charAt(i)===`
`?(s=" ",u=ae):(s=" ",u=m)):(s=R,u=ee,f=!0):(s=R,u=Se,f=!0)}else{var W=r.childNodes[i-1];if(W&&W.nodeType==1&&!ce(W)&&(W.tagName.toLowerCase()=="br"?(s=`
`,n.isBr=!0,u=m,f=!1):n.checkForTrailingSpace=!0),!s){var S=r.childNodes[i];S&&S.nodeType==1&&!ce(S)&&(n.checkForLeadingSpace=!0)}}n.prepopulatedChar=!0,n.character=s,n.characterType=u,n.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var n=this.characterType;return n==ee||n==Se},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var n=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();n&&(this.isTrailingSpace=!0,this.character=n,this.characterType=m),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var r=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();r&&(this.isLeadingSpace=!0,this.character=r,this.characterType=m),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(n){for(var r=this,i;r=r.previousVisible();)if(i=r.getCharacter(n),i!=="")return r;return null},getCharacter:function(n){this.resolveLeadingAndTrailingSpaces();var r=this.character,i,s=Ct(n.ignoreCharacters),u=r!==""&&s.indexOf(r)>-1;if(this.isCharInvariant)return i=u?"":r,i;var f=["character",n.includeSpaceBeforeBr,n.includeBlockContentTrailingSpace,n.includePreLineTrailingSpace,s].join("_"),d=this.cache.get(f);if(d!==null)return d;var R="",_=this.characterType==m,I,W,S=!1,te=this;function ie(){return S||(W=te.getPrecedingUncollapsedPosition(n),S=!0),W}return _&&(this.type==H?R=`
`:r==" "&&(!ie()||W.isTrailingSpace||W.character==`
`||W.character==" "&&W.characterType==m)||(r==`
`&&this.isLeadingSpace?ie()&&W.character!=`
`&&(R=`
`):(I=this.nextUncollapsed(),I&&(I.isBr?this.type=Q:I.isTrailingSpace&&I.character==`
`?this.type=A:I.isLeadingSpace&&I.character==`
`&&(this.type=z),I.character==`
`?this.type==Q&&!n.includeSpaceBeforeBr||this.type==z&&!n.includeSpaceBeforeBlock||this.type==A&&I.isTrailingSpace&&!n.includeBlockContentTrailingSpace||this.type==ae&&I.type==ee&&!n.includePreLineTrailingSpace||(r==`
`?I.isTrailingSpace?this.isTrailingSpace||this.isBr&&(I.type=G,ie()&&W.isLeadingSpace&&!W.isTrailingSpace&&W.character==`
`?I.character="":I.type=H):R=`
`:r==" "&&(R=" ")):R=r)))),s.indexOf(R)>-1&&(R=""),this.cache.set(f,R),R},equals:function(n){return!!n&&this.node===n.node&&this.offset===n.offset},inspect:X,toString:function(){return this.character}};ne.prototype=Y,ke(Y,{next:j("nextPos",function(n){var r=n.nodeWrapper,i=n.node,s=n.offset,u=r.session;if(!i)return null;var f,d,R;return s==r.getLength()?(f=i.parentNode,d=f?r.getNodeIndex()+1:0):r.isCharacterDataNode()?(f=i,d=s+1):(R=i.childNodes[s],u.getNodeWrapper(R).containsPositions()?(f=R,d=0):(f=i,d=s+1)),f?u.getPosition(f,d):null}),previous:j("previous",function(n){var r=n.nodeWrapper,i=n.node,s=n.offset,u=r.session,f,d,R;return s==0?(f=i.parentNode,d=f?r.getNodeIndex():0):r.isCharacterDataNode()?(f=i,d=s-1):(R=i.childNodes[s-1],u.getNodeWrapper(R).containsPositions()?(f=R,d=Ee.getNodeLength(R)):(f=i,d=s-1)),f?u.getPosition(f,d):null}),nextVisible:j("nextVisible",function(n){var r=n.next();if(!r)return null;var i=r.nodeWrapper,s=r.node,u=r;return i.isCollapsed()&&(u=i.session.getPosition(s.parentNode,i.getNodeIndex()+1)),u}),nextUncollapsed:j("nextUncollapsed",function(n){for(var r=n;r=r.nextVisible();)if(r.resolveLeadingAndTrailingSpaces(),r.character!=="")return r;return null}),previousVisible:j("previousVisible",function(n){var r=n.previous();if(!r)return null;var i=r.nodeWrapper,s=r.node,u=r;return i.isCollapsed()&&(u=i.session.getPosition(s.parentNode,i.getNodeIndex())),u})});var he=null,y=function(){function n(s){var u=new K;return{get:function(f){var d=u.get(f[s]);if(d){for(var R=0,_;_=d[R++];)if(_.node===f)return _}return null},set:function(f){var d=f.node[s],R=u.get(d)||u.set(d,[]);R.push(f)}}}var r=Ie.isHostProperty(document.documentElement,"uniqueID");function i(){this.initCaches()}return i.prototype={initCaches:function(){this.elementCache=r?function(){var s=new K;return{get:function(u){return s.get(u.uniqueID)},set:function(u){s.set(u.node.uniqueID,u)}}}():n("tagName"),this.textNodeCache=n("data"),this.otherNodeCache=n("nodeName")},getNodeWrapper:function(s){var u;switch(s.nodeType){case 1:u=this.elementCache;break;case 3:u=this.textNodeCache;break;default:u=this.otherNodeCache;break}var f=u.get(s);return f||(f=new Ce(s,this),u.set(f)),f},getPosition:function(s,u){return this.getNodeWrapper(s).getPosition(u)},getRangeBoundaryPosition:function(s,u){var f=u?"start":"end";return this.getPosition(s[f+"Container"],s[f+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},i}();function B(){return J(),he=new y}function q(){return he||B()}function J(){he&&he.detach(),he=null}ke(Ee,{nextNode:x,previousNode:M});function le(n,r,i,s){i&&(r?ce(i.node)&&(i=n.previousVisible()):ce(i.node)&&(i=i.nextVisible()));var u=n,f=!1;function d(){var I=null;return r?(I=u,f||(u=u.previousVisible(),f=!u||i&&u.equals(i))):f||(I=u=u.nextVisible(),f=!u||i&&u.equals(i)),f&&(u=null),I}var R,_=!1;return{next:function(){if(_)return _=!1,R;for(var I,W;I=d();)if(W=I.getCharacter(s),W)return R=I,I;return null},rewind:function(){if(R)_=!0;else throw fe.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.")},dispose:function(){n=i=null}}}var ye=Array.prototype.indexOf?function(n,r){return n.indexOf(r)}:function(n,r){for(var i=0,s=n.length;i<s;++i)if(n[i]===r)return i;return-1};function ge(n,r,i){var s=le(n,!1,null,r),u=le(n,!0,null,r),f=i.tokenizer;function d(te){for(var ie,we,Be=[],Ae=te?s:u,be=!1,Me=!1;ie=Ae.next();){if(we=ie.character,et.test(we))Me&&(Me=!1,be=!0);else if(be){Ae.rewind();break}else Me=!0;Be.push(ie)}return Be}var R=d(!0),_=d(!1).reverse(),I=rt(_.concat(R),i,f),W=R.length?I.slice(ye(I,R[0].token)):[],S=_.length?I.slice(0,ye(I,_.pop().token)+1):[];return{nextEndToken:function(){for(var te,ie;W.length==1&&!(te=W[0]).isWord&&(ie=d(!0)).length>0;)W=rt(te.chars.concat(ie),i,f);return W.shift()},previousStartToken:function(){for(var te,ie;S.length==1&&!(te=S[0]).isWord&&(ie=d(!1)).length>0;)S=rt(ie.reverse().concat(te.chars),i,f);return S.pop()},dispose:function(){s.dispose(),u.dispose(),W=S=null}}}function Re(n,r,i,s,u){var f=0,d,R=n,_,I,W=Math.abs(i),S;if(i!==0){var te=i<0;switch(r){case He:for(_=le(n,te,null,s);(d=_.next())&&f<W;)++f,R=d;I=d,_.dispose();break;case at:for(var ie=ge(n,s,u),we=te?ie.previousStartToken:ie.nextEndToken;(S=we())&&f<W;)S.isWord&&(++f,R=te?S.chars[0]:S.chars[S.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+r+"' not implemented")}te?(R=R.previousVisible(),f=-f):R&&R.isLeadingSpace&&!R.isTrailingSpace&&(r==at&&(_=le(n,!1,null,s),I=_.next(),_.dispose()),I&&(R=I.previousVisible()))}return{position:R,unitsMoved:f}}function pe(n,r,i,s){var u=n.getRangeBoundaryPosition(r,!0),f=n.getRangeBoundaryPosition(r,!1),d=s?f:u,R=s?u:f;return le(d,!!s,R,i)}function Ne(n,r,i){for(var s=[],u=pe(n,r,i),f;f=u.next();)s.push(f);return u.dispose(),s}function Te(n,r,i){var s=ue.createRange(n.node);return s.setStartAndEnd(n.node,n.offset,r.node,r.offset),!s.expand("word",{wordOptions:i})}function l(n,r,i,s,u){var f=st(u.direction),d=le(n,f,n.session.getRangeBoundaryPosition(s,f),u.characterOptions),R="",_=[],I,W,S,te,ie,we,Be=null;function Ae(be,Me){var je=_[be].previousVisible(),qe=_[Me-1],e=!u.wholeWordsOnly||Te(je,qe,u.wordOptions);return{startPos:je,endPos:qe,valid:e}}for(;I=d.next();)if(W=I.character,!i&&!u.caseSensitive&&(W=W.toLowerCase()),f?(_.unshift(I),R=W+R):(_.push(I),R+=W),i){if(ie=r.exec(R),ie)if(S=ie.index,te=S+ie[0].length,we){if(!f&&te<R.length||f&&S>0){Be=Ae(S,te);break}}else we=!0}else if((S=R.indexOf(r))!=-1){Be=Ae(S,S+r.length);break}return we&&(Be=Ae(S,te)),d.dispose(),Be}function p(n){return function(){var r=!!he,i=q(),s=[i].concat(Ie.toArray(arguments)),u=n.apply(this,s);return r||J(),u}}function k(n,r){return p(function(i,s,u,f){typeof u==Oe&&(u=s,s=He),f=Ye(f,ht);var d=n;r&&(d=u>=0,this.collapse(!d));var R=Re(i.getRangeBoundaryPosition(this,d),s,u,f.characterOptions,f.wordOptions),_=R.position;return this[d?"setStart":"setEnd"](_.node,_.offset),R.unitsMoved})}function D(n){return p(function(r,i){i=Ge(i,Ve);for(var s,u=pe(r,this,i,!n),f=0;(s=u.next())&&et.test(s.character);)++f;u.dispose();var d=f>0;return d&&this[n?"moveStart":"moveEnd"]("character",n?f:-f,{characterOptions:i}),d})}ke(ue.rangePrototype,{moveStart:k(!0,!1),moveEnd:k(!1,!1),move:k(!0,!0),trimStart:D(!0),trimEnd:D(!1),trim:p(function(n,r){var i=this.trimStart(r),s=this.trimEnd(r);return i||s}),expand:p(function(n,r,i){var s=!1;i=Ye(i,lt);var u=i.characterOptions;if(r||(r=He),r==at){var f=i.wordOptions,d=n.getRangeBoundaryPosition(this,!0),R=n.getRangeBoundaryPosition(this,!1),_=ge(d,u,f),I=_.nextEndToken(),W=I.chars[0].previousVisible(),S,te;if(this.collapsed)S=I;else{var ie=ge(R,u,f);S=ie.previousStartToken()}return te=S.chars[S.chars.length-1],W.equals(d)||(this.setStart(W.node,W.offset),s=!0),te&&!te.equals(R)&&(this.setEnd(te.node,te.offset),s=!0),i.trim&&(i.trimStart&&(s=this.trimStart(u)||s),i.trimEnd&&(s=this.trimEnd(u)||s)),s}else return this.moveEnd(He,1,i)}),text:p(function(n,r){return this.collapsed?"":Ne(n,this,Ge(r,Ve)).join("")}),selectCharacters:p(function(n,r,i,s,u){var f={characterOptions:u};r||(r=Qe(this.getDocument())),this.selectNodeContents(r),this.collapse(!0),this.moveStart("character",i,f),this.collapse(!0),this.moveEnd("character",s-i,f)}),toCharacterRange:p(function(n,r,i){r||(r=Qe(this.getDocument()));var s=r.parentNode,u=Ee.getNodeIndex(r),f=Ee.comparePoints(this.startContainer,this.endContainer,s,u)==-1,d=this.cloneRange(),R,_;return f?(d.setStartAndEnd(this.startContainer,this.startOffset,s,u),R=-d.text(i).length):(d.setStartAndEnd(s,u,this.startContainer,this.startOffset),R=d.text(i).length),_=R+this.text(i).length,{start:R,end:_}}),findText:p(function(n,r,i){i=Ye(i,ct),i.wholeWordsOnly&&(i.wordOptions.includeTrailingSpace=!1);var s=st(i.direction),u=i.withinRange;u||(u=ue.createRange(),u.selectNodeContents(this.getDocument()));var f=r,d=!1;typeof f=="string"?i.caseSensitive||(f=f.toLowerCase()):d=!0;var R=n.getRangeBoundaryPosition(this,!s),_=u.comparePoint(R.node,R.offset);_===-1?R=n.getRangeBoundaryPosition(u,!0):_===1&&(R=n.getRangeBoundaryPosition(u,!1));for(var I=R,W=!1,S;;)if(S=l(I,f,d,u,i),S){if(S.valid)return this.setStartAndEnd(S.startPos.node,S.startPos.offset,S.endPos.node,S.endPos.offset),!0;I=s?S.startPos:S.endPos}else if(i.wrap&&!W)u=u.cloneRange(),I=n.getRangeBoundaryPosition(u,!s),u.setBoundary(R.node,R.offset,s),W=!0;else return!1}),pasteHtml:function(n){if(this.deleteContents(),n){var r=this.createContextualFragment(n),i=r.lastChild;this.insertNode(r),this.collapseAfter(i)}}});function oe(n){return p(function(r,i){var s=!1;return this.changeEachRange(function(u){s=u[n](i)||s}),s})}ke(ue.selectionPrototype,{expand:p(function(n,r,i){this.changeEachRange(function(s){s.expand(r,i)})}),move:p(function(n,r,i,s){var u=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);s||(s={}),s.characterOptions=Ge(s.characterOptions,it),u=f.move(r,i,s),this.setSingleRange(f)}return u}),trimStart:oe("trimStart"),trimEnd:oe("trimEnd"),trim:oe("trim"),selectCharacters:p(function(n,r,i,s,u,f){var d=ue.createRange(r);d.selectCharacters(r,i,s,f),this.setSingleRange(d,u)}),saveCharacterRanges:p(function(n,r,i){for(var s=this.getAllRanges(),u=s.length,f=[],d=u==1&&this.isBackward(),R=0,_=s.length;R<_;++R)f[R]={characterRange:s[R].toCharacterRange(r,i),backward:d,characterOptions:i};return f}),restoreCharacterRanges:p(function(n,r,i){this.removeAllRanges();for(var s=0,u=i.length,f,d,R;s<u;++s)d=i[s],R=d.characterRange,f=ue.createRange(r),f.selectCharacters(r,R.start,R.end,d.characterOptions),this.addRange(f,d.backward)}),text:p(function(n,r){for(var i=[],s=0,u=this.rangeCount;s<u;++s)i[s]=this.getRangeAt(s).text(r);return i.join("")})}),ue.innerText=function(n,r){var i=ue.createRange(n);i.selectNodeContents(n);var s=i.text(r);return s},ue.createWordIterator=function(n,r,i){var s=q();i=Ye(i,gt);var u=s.getPosition(n,r),f=ge(u,i.characterOptions,i.wordOptions),d=st(i.direction);return{next:function(){return d?f.previousStartToken():f.nextEndToken()},dispose:function(){f.dispose(),this.next=function(){}}}},ue.noMutation=function(n){var r=q();n(r),J()},ue.noMutation.createEntryPointFunction=p,ue.textRange={isBlockNode:ft,isCollapsedWhitespaceNode:re,createPosition:p(function(n,r,i){return n.getPosition(r,i)})}}),xe})})(At);var It=At.exports;const Bt=Dt(It);const Ot=document.querySelector("input");Ot.addEventListener("input",()=>{CSS.highlights.delete("my-highlight");const Pe=Ot.value;if(!Pe)return;const Ue=Bt.createRange(),xe=[];for(;Ue.findText(Pe);)xe.push(Ue.cloneRange().nativeRange),Ue.collapse(!1);if(xe.length){const ue=new Highlight(...xe);CSS.highlights.set("my-highlight",ue)}});
